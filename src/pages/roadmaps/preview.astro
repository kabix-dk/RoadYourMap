---
import Layout from '@/layouts/Layout.astro';
import { RoadmapDisplay } from '@/components/roadmap/RoadmapDisplay';
import type { RoadmapDetailsDto, RoadmapItemDto } from '@/types';
import { generateRoadmapItems } from '@/lib/mocked.roadmap.service';

// Create mock data for development/preview
const mockCommand = {
  title: 'Java Development Roadmap',
  experience_level: 'Beginner',
  technology: 'Java',
  goals: 'Learn Java programming from scratch',
  additional_info: null,
};

// Generate the roadmap items with proper UUIDs
const mockRoadmapItems = await generateRoadmapItems(mockCommand);

// Create the full roadmap data
const mockRoadmapData: RoadmapDetailsDto = {
  id: '550e8400-e29b-41d4-a716-446655440999', // Mock roadmap ID
  title: mockCommand.title,
  experience_level: mockCommand.experience_level,
  technology: mockCommand.technology,
  goals: mockCommand.goals,
  additional_info: mockCommand.additional_info,
  created_at: new Date().toISOString(),
  updated_at: new Date().toISOString(),
  items: mockRoadmapItems.map(item => ({
    id: item.id,
    parent_item_id: item.parent_item_id,
    title: item.title,
    description: item.description,
    level: item.level,
    position: item.position,
    is_completed: item.is_completed,
    completed_at: null,
  })) as RoadmapItemDto[],
};

// Use mock data instead of expecting it from props
const roadmapData = mockRoadmapData;
---

<Layout title="Preview Roadmap">
  <main class="container mx-auto py-8 px-4">
    <h1 class="text-3xl font-bold mb-8">Preview Generated Roadmap</h1>
    <RoadmapDisplay client:load roadmapData={roadmapData} />
  </main>
</Layout> 